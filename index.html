<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Gifts Forge</title>
<style>
  :root {
    --bg:#000;
    --accent:#ff7b00;
    --text:#fff;
    --card:#111;
    --border:#ff7b00aa;
  }
  *{box-sizing:border-box;font-family:'Segoe UI',sans-serif}
  body{margin:0;background:var(--bg);color:var(--text);display:flex;flex-direction:column;height:100vh}
  header{display:flex;justify-content:space-between;align-items:center;padding:10px 20px;border-bottom:2px solid var(--accent);background:#111;font-size:1.2rem}
  header .balance{font-size:1rem}
  main{flex:1;display:flex;justify-content:center;align-items:center;padding:20px}
  footer{display:flex;justify-content:space-around;border-top:2px solid var(--accent);background:#111;padding:10px 0}
  footer button{background:none;border:none;color:var(--text);font-size:1rem;cursor:pointer}
  footer button.active{color:var(--accent);font-weight:bold}

  /* Forge */
  .forge-area{max-width:480px;width:100%;text-align:center;background:var(--card);border:2px solid var(--border);border-radius:16px;padding:20px;box-shadow:0 0 10px #ff7b0044}
  .forge-slots{display:grid;grid-template-columns:repeat(3,1fr);gap:10px;margin-top:10px}
  .slot{height:80px;border:2px dashed var(--accent);border-radius:10px;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:.2s}
  .slot:hover{background:#222}
  .slot.filled{border-style:solid;background:#222}
  .forge-btn{margin-top:15px;background:var(--accent);color:#000;border:none;border-radius:10px;padding:10px 20px;font-size:1.1rem;cursor:pointer;transition:.2s}
  .forge-btn:hover{transform:scale(1.05)}
  .forge-result{margin-top:10px;min-height:1.5em}
  @keyframes forgeGlow{0%,100%{box-shadow:0 0 10px #ff7b00}50%{box-shadow:0 0 25px #ff7b00}}
  .forging{animation:forgeGlow 1s infinite}

  /* Inventory */
  .inventory,.shop{max-width:500px;width:100%;background:var(--card);border:2px solid var(--border);border-radius:16px;padding:20px;text-align:center}
  .inv-grid{display:flex;flex-wrap:wrap;gap:10px;justify-content:center;margin-top:10px}
  .inv-item{width:70px;height:70px;border:2px solid var(--accent);border-radius:10px;display:flex;align-items:center;justify-content:center;cursor:pointer;position:relative}
  .inv-item:hover::after{content:'–ü—Ä–æ–¥–∞—Ç—å';position:absolute;bottom:-20px;font-size:.7rem;color:var(--accent)}
  .shop-grid{display:flex;flex-wrap:wrap;gap:10px;justify-content:center;margin-top:10px}
  .shop-item{width:130px;padding:10px;border:2px solid var(--accent);border-radius:10px;background:#222;cursor:pointer}
  .shop-item:hover{box-shadow:0 0 10px var(--accent)}
</style>
</head>
<body>
<header>
  <div>üî• Gifts Forge</div>
  <div class="balance">‚≠ê <span id="stars">10000</span></div>
</header>

<main>
  <!-- –ú–∞–≥–∞–∑–∏–Ω -->
  <div id="shopTab" class="shop hidden">
    <h2>üõí –ú–∞–≥–∞–∑–∏–Ω –º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–≤</h2>
    <div class="shop-grid" id="shopItems"></div>
  </div>

  <!-- –ö—É–∑–Ω–∏—Ü–∞ -->
  <div id="forgeTab" class="forge-area">
    <h2>–ö—É–∑–Ω–∏—Ü–∞</h2>
    <p>–î–æ–±–∞–≤—å –¥–æ 6 —ç–ª–µ–º–µ–Ω—Ç–æ–≤</p>
    <div class="forge-slots" id="forgeSlots"></div>
    <button class="forge-btn" id="forgeBtn">–ö–æ–≤–∞—Ç—å!</button>
    <div class="forge-result" id="forgeResult"></div>
  </div>

  <!-- –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å -->
  <div id="inventoryTab" class="inventory hidden">
    <h2>üéÅ –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å</h2>
    <div class="inv-grid" id="inventoryGrid"></div>
  </div>
</main>

<footer>
  <button id="navShop">üõí –ú–∞–≥–∞–∑–∏–Ω</button>
  <button id="navForge" class="active">üî® –ö—É–∑–Ω–∏—Ü–∞</button>
  <button id="navInventory">üéÅ –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å</button>
</footer>

<script>
/* ====== –î–ê–ù–ù–´–ï ====== */
let stars = 10000;
const giftsList = [
    {name:"Plush Pepe", ton:4930},{name:"Heart Locket", ton:1210},{name:"Durov's Cap", ton:870},
    {name:"Precious Peach", ton:389.5},{name:"Heroic Helmet", ton:255},{name:"Mighty Arm", ton:199.99},
    {name:"Nail Bracelet", ton:124.8},{name:"Astral Shard", ton:119.13},{name:"Artisan Brick", ton:110.24},
    {name:"Mini Oscar", ton:93.19},{name:"Loot Bag", ton:93},{name:"Ion Gem", ton:82.38},{name:"Perfume Bottle", ton:80.62},
    {name:"Magic Potion", ton:73.9},{name:"Gem Signet", ton:66.89},{name:"Scared Cat", ton:57.69},{name:"Bonded Ring", ton:53.97},
    {name:"Westside Sign", ton:53.6},{name:"Genie Lamp", ton:47},{name:"Swiss Watch", ton:40},{name:"Sharp Tongue", ton:39.76},
    {name:"Kissed Frog", ton:31.25},{name:"Electric Skull", ton:30.4},{name:"Signet Ring", ton:27.78},{name:"Neko Helmet", ton:27},
    {name:"Low Rider", ton:26.11},{name:"Vintage Cigar", ton:25},{name:"Toy Bear", ton:24.11},{name:"Voodoo Doll", ton:18.88},
    {name:"Mad Pumpkin", ton:18.27},{name:"Diamond Ring", ton:18},{name:"Eternal Rose", ton:15.17},{name:"Ionic Dryer", ton:11.4},
    {name:"Cupid Charm", ton:11.01},{name:"Love Potion", ton:10.38},{name:"Flying Broom", ton:9.77},{name:"Trapped Heart", ton:8.67},
    {name:"Top Hat", ton:8.57},{name:"Skull Flower", ton:8.48},{name:"Crystal Ball", ton:8.24},{name:"Record Player", ton:8},
    {name:"Sky Stilettos", ton:7.32},{name:"Love Candle", ton:7.15},{name:"Sleigh Bell", ton:6.6},{name:"Snoop Cigar", ton:5.89},
    {name:"Hanging Star", ton:5.3},{name:"Sakura Flower", ton:5.21},{name:"Valentine Box", ton:4.61},{name:"Jolly Chimp", ton:4.51},
    {name:"Evil Eye", ton:4.4},{name:"Berry Box", ton:3.98},{name:"Eternal Candle", ton:3.92},{name:"Snow Mittens", ton:3.9},
    {name:"Spy Agaric", ton:3.88},{name:"Input Key", ton:3.76},{name:"Jelly Bunny", ton:3.75},{name:"Bow Tie", ton:3.6},
    {name:"Bunny Muffin", ton:3.46},{name:"Light Sword", ton:3.3},{name:"Witch Hat", ton:3.14},{name:"Hex Pot", ton:3.07},
    {name:"Lush Bouquet", ton:3.07},{name:"Joyful Bundle", ton:3.07},{name:"Snow Globe", ton:2.89},{name:"Restless Jar", ton:2.72},
    {name:"Santa Hat", ton:2.68},{name:"Easter Egg", ton:2.61},{name:"Star Notepad", ton:2.5},{name:"Moon Pendant", ton:2.5},
    {name:"Jack-in-the-Box", ton:2.4},{name:"Swag Bag", ton:2.4},{name:"Fresh Socks", ton:2.2},{name:"Spiced Wine", ton:2.19},
    {name:"Stellar Rocket", ton:2.18},{name:"Snoop Dogg", ton:2.15},{name:"Cookie Heart", ton:2.12},{name:"Jingle Bells", ton:2.12},
    {name:"Tama Gadget", ton:2.11},{name:"Hypno Lollipop", ton:2.09},{name:"Winter Wreath", ton:2.06},{name:"Party Sparkler", ton:2.06},
    {name:"Ginger Cookie", ton:2.05},{name:"Big Year", ton:2.02},{name:"Jester Hat", ton:2},{name:"Holiday Drink", ton:1.93},
    {name:"Pet Snake", ton:1.93},{name:"Homemade Cake", ton:1.91},{name:"Candy Cane", ton:1.89},{name:"Clover Pin", ton:1.88},
    {name:"Whip Cupcake", ton:1.8},{name:"Xmas Stocking", ton:1.77},{name:"Snake Box", ton:1.72},{name:"Lunar Snake", ton:1.7},
    {name:"Lol Pop", ton:1.67},{name:"B-Day Candle", ton:1.61},{name:"Desk Calendar", ton:1.5}
  ];
const modsBase=[
  {name:'üíé +10% –∫ —Ü–µ–Ω–µ',type:'plus10',desc:'+10% –∫ —Ü–µ–Ω–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞',cost:800},
  {name:'üé≤ ¬±30% –∫ —Ü–µ–Ω–µ',type:'rand30',desc:'–°–ª—É—á–∞–π–Ω–æ +30% –∏–ª–∏ -30%',cost:1000},
  {name:'üîÅ –í–µ—Ä–Ω—É—Ç—å 1 –ø–æ–¥–∞—Ä–æ–∫',type:'return1',desc:'15% —à–∞–Ω—Å –≤–µ—Ä–Ω—É—Ç—å –æ–¥–∏–Ω –∏–∑ –ø–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã—Ö',cost:1200},
  {name:'‚ú® –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä',type:'keepmod',desc:'–®–∞–Ω—Å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä',cost:900}
];
let inventory=[]; // –Ω–∞—á–∞–ª—å–Ω—ã–π –ø—É—Å—Ç–æ–π
// –∑–∞–ø–æ–ª–Ω–∏–º 10 –ø–æ–¥–∞—Ä–∫–æ–≤ –¥–ª—è —Ç–µ—Å—Ç–∞
for(let i=0;i<10;i++){inventory.push({...gifts[i%gifts.length]});}
let forgeSlots=[null,null,null,null,null,null];
let shopItems=[];

/* ====== –£–¢–ò–õ–ò–¢–´ ====== */
function $(id){return document.getElementById(id);}
function renderStars(){ $('stars').textContent=Math.floor(stars); }
function addStars(x){stars+=x;renderStars();}
function spendStars(x){ if(stars>=x){stars-=x;renderStars();return true;} return false; }

/* ====== –†–ï–ù–î–ï–† –°–õ–û–¢–û–í ====== */
function renderForge(){
  const box=$('forgeSlots'); box.innerHTML='';
  forgeSlots.forEach((item,i)=>{
    const div=document.createElement('div');
    div.className='slot'+(item?' filled':'');
    div.textContent=item?item.name:'Ôºã';
    div.onclick=()=>selectItemForSlot(i);
    box.appendChild(div);
  });
}

/* ====== –í–´–ë–û–† –ü–†–ï–î–ú–ï–¢–ê –ò–ó –ò–ù–í–ï–ù–¢–ê–†–Ø ====== */
function selectItemForSlot(idx){
  const list=inventory.map((x,i)=>`${i+1}. ${x.name}`).join('\n');
  const input=prompt(`–í—ã–±–µ—Ä–∏ –ø—Ä–µ–¥–º–µ—Ç (1-${inventory.length}):\n${list}`);
  const choice=parseInt(input);
  if(!isNaN(choice)&&inventory[choice-1]){
    forgeSlots[idx]=inventory[choice-1];
    renderForge();
  }
}

/* ====== –ö–û–í–ö–ê ====== */
$('forgeBtn').onclick=()=>{
  const chosen=forgeSlots.filter(x=>x);
  if(chosen.length<2){$('forgeResult').textContent='‚ùó –ù—É–∂–Ω–æ –º–∏–Ω–∏–º—É–º 2 –ø—Ä–µ–¥–º–µ—Ç–∞';return;}
  $('forgeBtn').disabled=true;
  $('forgeBtn').classList.add('forging');
  $('forgeResult').textContent='‚öôÔ∏è –ö–æ–≤–∫–∞...';
  setTimeout(()=>{
    $('forgeBtn').disabled=false;
    $('forgeBtn').classList.remove('forging');
    const fail=Math.random()<0.15; // 15% –Ω–µ—É–¥–∞—á–∞
    if(fail){
      $('forgeResult').textContent='üí• –ù–µ—É–¥–∞—á–∞! –í—Å—ë –ø—Ä–æ–ø–∞–ª–æ.';
      chosen.forEach(x=>{
        const i=inventory.indexOf(x);
        if(i>-1)inventory.splice(i,1);
      });
    } else {
      const sum=chosen.reduce((a,b)=>a+b.price,0);
      let factor=0.5+Math.random()*1.25; // 0.5 - 1.75 –¥–∏–∞–ø–∞–∑–æ–Ω
      let modBonus=1;
      if(chosen.some(c=>c.type==='plus10')) modBonus+=0.1;
      if(chosen.some(c=>c.type==='rand30')) modBonus+=Math.random()<0.5?-0.3:0.3;
      const newPrice=sum*factor*modBonus/Math.max(chosen.length,1);
      const gift={name:'üéÅ Gift '+(inventory.length+1),price:newPrice};
      inventory.push(gift);
      $('forgeResult').textContent=`‚úÖ –£—Å–ø–µ—Ö! –ù–æ–≤—ã–π –ø–æ–¥–∞—Ä–æ–∫: ${gift.name} (${newPrice.toFixed(1)} TON)`;
      // —à–∞–Ω—Å –≤–µ—Ä–Ω—É—Ç—å 1 –ø—Ä–µ–¥–º–µ—Ç
      if(chosen.some(c=>c.type==='return1') && Math.random()<0.15){
        const ret=chosen[Math.floor(Math.random()*chosen.length)];
        inventory.push(ret);
        $('forgeResult').textContent+=' (–û–¥–∏–Ω –ø—Ä–µ–¥–º–µ—Ç –≤–æ–∑–≤—Ä–∞—â—ë–Ω!)';
      }
      // —É–¥–∞–ª–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ
      chosen.forEach(x=>{
        const i=inventory.indexOf(x);
        if(i>-1)inventory.splice(i,1);
      });
    }
    forgeSlots=[null,null,null,null,null,null];
    renderInventory();
    renderForge();
  },2000);
};

/* ====== –ò–ù–í–ï–ù–¢–ê–†–¨ ====== */
function renderInventory(){
  const box=$('inventoryGrid'); box.innerHTML='';
  if(inventory.length===0){box.innerHTML='<p>–ü—É—Å—Ç–æ</p>';return;}
  inventory.forEach((x,i)=>{
    const div=document.createElement('div');
    div.className='inv-item';
    div.textContent=x.name;
    div.title='–¶–µ–Ω–∞: '+x.price.toFixed(1)+' TON';
    div.onclick=()=>{
      if(confirm(`–ü—Ä–æ–¥–∞—Ç—å ${x.name} –∑–∞ ${Math.floor(x.price*142)} ‚≠ê ?`)){
        addStars(x.price*142);
        inventory.splice(i,1);
        renderInventory();
      }
    };
    box.appendChild(div);
  });
}

/* ====== –ú–ê–ì–ê–ó–ò–ù ====== */
function randomShop(){
  shopItems=[];
  for(let i=0;i<3;i++){
    const mod={...modsBase[Math.floor(Math.random()*modsBase.length)]};
    mod.cost=500+Math.floor(Math.random()*1000);
    shopItems.push(mod);
  }
}
function renderShop(){
  const box=$('shopItems'); box.innerHTML='';
  shopItems.forEach(mod=>{
    const div=document.createElement('div');
    div.className='shop-item';
    div.innerHTML=`<strong>${mod.name}</strong><br>${mod.desc}<br>‚≠ê ${mod.cost}`;
    div.onclick=()=>{
      if(spendStars(mod.cost)){
        inventory.push(mod);
        renderInventory();
        alert(`–ö—É–ø–ª–µ–Ω –º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä ${mod.name}`);
      } else alert('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∑–≤—ë–∑–¥!');
    };
    box.appendChild(div);
  });
}

/* ====== –ù–ê–í–ò–ì–ê–¶–ò–Ø ====== */
function show(tab){
  ['shop','forge','inventory'].forEach(t=>{
    $(t+'Tab').classList.add('hidden');
    $('nav'+t.charAt(0).toUpperCase()+t.slice(1)).classList.remove('active');
  });
  $(tab+'Tab').classList.remove('hidden');
  $('nav'+tab.charAt(0).toUpperCase()+tab.slice(1)).classList.add('active');
  if(tab==='inventory')renderInventory();
  if(tab==='shop')renderShop();
}
$('navForge').onclick=()=>show('forge');
$('navInventory').onclick=()=>show('inventory');
$('navShop').onclick=()=>{randomShop();show('shop');};

/* ====== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ====== */
renderStars();
renderForge();
renderInventory();
</script>
</body>
</html>
