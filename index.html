<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Gifts Forge</title>
<style>
:root {
  --bg: #0d0d0d;
  --accent: #ff7b00;
  --text: #fff;
  --card-bg: #1a1a1a;
  --card-border: #ff7b00aa;
  --success: #4caf50;
  --fail: #e53935;
  --rare: #00aaff;
  --epic: #a200ff;
  --legendary: #ff0044;
}
*{box-sizing:border-box;font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;}
body{margin:0;background-color:var(--bg);color:var(--text);display:flex;flex-direction:column;height:100vh;}
header{text-align:center;padding:12px 0;background:#111;border-bottom:2px solid var(--accent);font-size:1.4rem;letter-spacing:1px;position:relative;}
#starBalance{position:absolute;right:20px;top:12px;font-size:1rem;color:var(--accent);}
main{flex:1;display:flex;flex-direction:column;align-items:center;justify-content:flex-start;padding:20px;}
.hidden{display:none;}
.forge-area,.inventory,.shop{text-align:center;max-width:700px;width:100%;border:2px solid var(--card-border);background:var(--card-bg);border-radius:16px;padding:20px;margin-bottom:20px;box-shadow:0 0 10px #ff7b0033;}
.forge-cards{display:grid;grid-template-columns:repeat(3,1fr);gap:15px;margin-top:20px;}
.forge-card{height:100px;border:2px dashed var(--accent);border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:1.2rem;cursor:pointer;transition:0.3s;background:#222;}
.forge-card.selected{border:2px solid var(--accent);background:var(--accent);color:#000;transform:scale(1.05);}
#forgeButton{margin-top:20px;background:var(--accent);color:#000;border:none;border-radius:12px;padding:12px 25px;font-size:1.1rem;cursor:pointer;transition:0.2s;}
#forgeButton:hover{transform:scale(1.05);box-shadow:0 0 15px var(--accent);}
.result{margin-top:15px;font-size:1.1rem;color:var(--accent);min-height:1.2em;}
footer{display:flex;justify-content:space-around;border-top:2px solid var(--accent);background:#111;padding:12px 0;}
footer button{background:none;border:none;color:var(--text);font-size:1.1rem;cursor:pointer;}
footer button.active{color:var(--accent);font-weight:bold;}
.inventory h2,.shop h2{color:var(--accent);margin-bottom:10px;}
.inventory-items,.shop-items{display:flex;flex-wrap:wrap;justify-content:center;gap:10px;}
.inv-item,.shop-item{width:90px;height:90px;border:2px solid var(--accent);border-radius:12px;display:flex;flex-direction:column;align-items:center;justify-content:center;background:#222;text-align:center;padding:5px;font-size:0.8rem;cursor:pointer;transition:.3s;}
.inv-item:hover,.shop-item:hover{background:var(--accent);color:#000;}
.inv-item.rare{border-color:var(--rare);box-shadow:0 0 10px var(--rare);}
.inv-item.epic{border-color:var(--epic);box-shadow:0 0 10px var(--epic);}
.inv-item.legendary{border-color:var(--legendary);box-shadow:0 0 12px var(--legendary);}
.modal{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.85);display:flex;align-items:center;justify-content:center;z-index:1000;display:none;}
.modal-content{background:#111;padding:20px;border:2px solid var(--accent);border-radius:16px;width:90%;max-width:500px;max-height:80%;overflow-y:auto;}
.modal-content h3{color:var(--accent);margin-bottom:10px;}
.search-input{width:100%;padding:8px;margin-bottom:10px;border-radius:8px;border:1px solid #555;background:#222;color:#fff;}
.modal-item{padding:10px;border:1px solid var(--accent);border-radius:10px;margin-bottom:8px;cursor:pointer;transition:0.2s;background:#222;}
.modal-item:hover{background:var(--accent);color:#000;}
.forge-anim{animation:glow 1s infinite;}
@keyframes glow{0%,100%{box-shadow:0 0 10px var(--accent);}50%{box-shadow:0 0 25px var(--accent);}}
@keyframes forgeSpark {0%{box-shadow:0 0 10px var(--accent);}50%{box-shadow:0 0 20px var(--success);}100%{box-shadow:0 0 10px var(--accent);}}
.forge-ready{animation:forgeSpark 1.5s infinite;}
.shop-tabs{display:flex;justify-content:center;gap:10px;margin-bottom:10px;}
.shop-tab-btn{background:#222;border:1px solid var(--accent);color:var(--accent);padding:6px 12px;border-radius:8px;cursor:pointer;}
.shop-tab-btn.active{background:var(--accent);color:#000;font-weight:bold;}
#shopTimer{color:var(--accent);font-size:0.9rem;margin-top:5px;}
</style>
</head>
<body>
<header>üî• Gifts Forge üî• <span id="starBalance">‚≠ê 10 000</span></header>

<main>
  <!-- –ö—É–∑–Ω–∏—Ü–∞ -->
  <div id="forgeTab" class="forge-area">
    <h2>–ö—É–∑–Ω–∏—Ü–∞</h2>
    <p>–í—ã–±–µ—Ä–∏ 2‚Äì6 –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –¥–ª—è –∫–æ–≤–∫–∏ (—Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω –ø–æ–¥–∞—Ä–æ–∫)</p>
    <div class="forge-cards" id="forgeCards">
      <div class="forge-card">+</div>
      <div class="forge-card">+</div>
      <div class="forge-card">+</div>
      <div class="forge-card">+</div>
      <div class="forge-card">‚≠ê</div>
      <div class="forge-card">üß©</div>
    </div>
    <button id="forgeButton">–ö–æ–≤–∞—Ç—å!</button>
    <div class="result" id="forgeResult"></div>
  </div>

  <!-- –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å -->
  <div id="inventoryTab" class="inventory hidden">
    <h2>–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å</h2>
    <div class="inventory-items" id="inventoryItems"></div>
  </div>

  <!-- –ú–∞–≥–∞–∑–∏–Ω -->
  <div id="shopTab" class="shop hidden">
    <h2>–ú–∞–≥–∞–∑–∏–Ω</h2>
    <div class="shop-tabs">
      <button class="shop-tab-btn active" data-tab="mods">–ú–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã</button>
      <button class="shop-tab-btn" data-tab="boosts">–ë—É—Å—Ç–µ—Ä—ã</button>
      <button class="shop-tab-btn" data-tab="cases">–ö–µ–π—Å—ã</button>
    </div>
    <div id="shopTimer"></div>
    <div class="shop-items" id="shopItems"></div>
  </div>
</main>

<footer>
  <button id="navShop">üõí Shop</button>
  <button id="navForge" class="active">üî® Forge</button>
  <button id="navInventory">üéÅ Inventory</button>
</footer>

<!-- –ú–æ–¥–∞–ª–∫–∞ –≤—ã–±–æ—Ä–∞ –ø—Ä–µ–¥–º–µ—Ç–æ–≤ -->
<div class="modal" id="modal">
  <div class="modal-content">
    <h3>–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–µ–¥–º–µ—Ç</h3>
    <input type="text" id="searchInput" class="search-input" placeholder="–ü–æ–∏—Å–∫..." />
    <div id="modalItems"></div>
    <button id="closeModal" style="margin-top:10px;padding:8px 15px;background:var(--accent);border:none;border-radius:8px;color:#000;cursor:pointer;">–ó–∞–∫—Ä—ã—Ç—å</button>
  </div>
</div>

<script>
// ---------------------- –î–ê–ù–ù–´–ï ----------------------
const TON_TO_STARS = 142;
const gifts = [
  {name:"Plush Pepe", ton:4930},
  {name:"Heart Locket", ton:1210},
  {name:"Durov's Cap", ton:870},
  {name:"Precious Peach", ton:389.5},
  {name:"Heroic Helmet", ton:255},
  {name:"Mighty Arm", ton:199.99},
  {name:"Nail Bracelet", ton:124.8},
  {name:"Astral Shard", ton:119.13},
  {name:"Artisan Brick", ton:110.24},
  {name:"Mini Oscar", ton:93.19},
  {name:"Loot Bag", ton:93},
  {name:"Ion Gem", ton:82.38},
  {name:"Perfume Bottle", ton:80.62},
  {name:"Magic Potion", ton:73.9},
  {name:"Gem Signet", ton:66.89},
  {name:"Scared Cat", ton:57.69},
  {name:"Bonded Ring", ton:53.97},
  {name:"Westside Sign", ton:53.6},
  {name:"Genie Lamp", ton:47},
  {name:"Swiss Watch", ton:40},
  {name:"Sharp Tongue", ton:39.76},
  {name:"Kissed Frog", ton:31.25},
  {name:"Electric Skull", ton:30.4},
  {name:"Signet Ring", ton:27.78},
  {name:"Neko Helmet", ton:27},
  {name:"Low Rider", ton:26.11},
  {name:"Vintage Cigar", ton:25},
  {name:"Toy Bear", ton:24.11},
  {name:"Voodoo Doll", ton:18.88},
  {name:"Mad Pumpkin", ton:18.27},
  {name:"Diamond Ring", ton:18},
  {name:"Eternal Rose", ton:15.17},
  {name:"Ionic Dryer", ton:11.4},
  {name:"Cupid Charm", ton:11.01},
  {name:"Love Potion", ton:10.38},
  {name:"Flying Broom", ton:9.77},
  {name:"Trapped Heart", ton:8.67},
  {name:"Top Hat", ton:8.57},
  {name:"Skull Flower", ton:8.48},
  {name:"Crystal Ball", ton:8.24},
  {name:"Record Player", ton:8},
  {name:"Sky Stilettos", ton:7.32},
  {name:"Love Candle", ton:7.15},
  {name:"Sleigh Bell", ton:6.6},
  {name:"Snoop Cigar", ton:5.89},
  {name:"Hanging Star", ton:5.3},
  {name:"Sakura Flower", ton:5.21},
  {name:"Valentine Box", ton:4.61},
  {name:"Jolly Chimp", ton:4.51},
  {name:"Evil Eye", ton:4.4},
  {name:"Berry Box", ton:3.98},
  {name:"Eternal Candle", ton:3.92},
  {name:"Snow Mittens", ton:3.9},
  {name:"Spy Agaric", ton:3.88},
  {name:"Input Key", ton:3.76},
  {name:"Jelly Bunny", ton:3.75},
  {name:"Bow Tie", ton:3.6},
  {name:"Bunny Muffin", ton:3.46},
  {name:"Light Sword", ton:3.3},
  {name:"Witch Hat", ton:3.14},
  {name:"Hex Pot", ton:3.07},
  {name:"Lush Bouquet", ton:3.07},
  {name:"Joyful Bundle", ton:3.07},
  {name:"Snow Globe", ton:2.89},
  {name:"Restless Jar", ton:2.72},
  {name:"Santa Hat", ton:2.68},
  {name:"Easter Egg", ton:2.61},
  {name:"Star Notepad", ton:2.5},
  {name:"Moon Pendant", ton:2.5},
  {name:"Jack-in-the-Box", ton:2.4},
  {name:"Swag Bag", ton:2.4},
  {name:"Fresh Socks", ton:2.2},
  {name:"Spiced Wine", ton:2.19},
  {name:"Stellar Rocket", ton:2.18},
  {name:"Snoop Dogg", ton:2.15},
  {name:"Cookie Heart", ton:2.12},
  {name:"Jingle Bells", ton:2.12},
  {name:"Tama Gadget", ton:2.11},
  {name:"Hypno Lollipop", ton:2.09},
  {name:"Winter Wreath", ton:2.06},
  {name:"Party Sparkler", ton:2.06},
  {name:"Ginger Cookie", ton:2.05},
  {name:"Big Year", ton:2.02},
  {name:"Jester Hat", ton:2},
  {name:"Holiday Drink", ton:1.93},
  {name:"Pet Snake", ton:1.93},
  {name:"Homemade Cake", ton:1.91},
  {name:"Candy Cane", ton:1.89},
  {name:"Clover Pin", ton:1.88},
  {name:"Whip Cupcake", ton:1.8},
  {name:"Xmas Stocking", ton:1.77},
  {name:"Snake Box", ton:1.72},
  {name:"Lunar Snake", ton:1.7},
  {name:"Lol Pop", ton:1.67},
  {name:"B-Day Candle", ton:1.61},
  {name:"Desk Calendar", ton:1.5}
];

const modifiersPool = [
  {name:"+10% —à–∞–Ω—Å —É—Å–ø–µ—Ö–∞",effect:"forgePlus10"},
  {name:"+10% –∫ —Ü–µ–Ω–µ",effect:"plus10"},
  {name:"¬±30% –∫ —Ü–µ–Ω–µ",effect:"plusminus30"},
  {name:"15% —à–∞–Ω—Å –≤–µ—Ä–Ω—É—Ç—å",effect:"refund"}
];
const boostersPool = [
  {name:"5 –º–∏–Ω: +20% —à–∞–Ω—Å —É—Å–ø–µ—Ö–∞",effect:"boostForge",cost:2000,duration:300000},
  {name:"5 –º–∏–Ω: +15% –∫ –ø—Ä–æ–¥–∞–∂–∞–º",effect:"boostSell",cost:1500,duration:300000}
];
const casesPool = [
  {name:"–ú–∞–ª—ã–π –∫–µ–π—Å",cost:1500},
  {name:"–ë–æ–ª—å—à–æ–π –∫–µ–π—Å",cost:4000},
  {name:"–ü—Ä–µ–º–∏—É–º –∫–µ–π—Å",cost:8000}
];

let stars=10000;
let inventory=gifts.slice();
let selectedComponents=Array(6).fill(null);
let activeCardIndex=null;
let modifiers=[];
let activeBoosts=[];
let shopTab='mods';
let shopTimer=60;

// ---------------------- –≠–õ–ï–ú–ï–ù–¢–´ ----------------------
const starBalanceElem=document.getElementById('starBalance');
const forgeCards=document.querySelectorAll('.forge-card');
const forgeButton=document.getElementById('forgeButton');
const forgeResult=document.getElementById('forgeResult');
const inventoryContainer=document.getElementById('inventoryItems');
const shopItems=document.getElementById('shopItems');
const shopTimerElem=document.getElementById('shopTimer');
const modal=document.getElementById('modal');
const modalItems=document.getElementById('modalItems');
const searchInput=document.getElementById('searchInput');
const closeModal=document.getElementById('closeModal');
const navForge=document.getElementById('navForge');
const navInventory=document.getElementById('navInventory');
const navShop=document.getElementById('navShop');
const forgeTab=document.getElementById('forgeTab');
const inventoryTab=document.getElementById('inventoryTab');
const shopTabElem=document.getElementById('shopTab');
const shopTabBtns=document.querySelectorAll('.shop-tab-btn');

// ---------------------- –û–¢–û–ë–†–ê–ñ–ï–ù–ò–ï ----------------------
function renderStars(){
  starBalanceElem.textContent=`‚≠ê ${stars.toLocaleString()}`;
}
function rarityClass(value){
  if(value>10000) return "legendary";
  if(value>5000) return "epic";
  if(value>1000) return "rare";
  return "";
}
function renderInventory(){
  inventoryContainer.innerHTML="";
  if(!inventory.length){inventoryContainer.innerHTML="<p>–ü—É—Å—Ç–æ...</p>";return;}
  inventory.forEach((item,idx)=>{
    const div=document.createElement("div");
    div.className=`inv-item ${rarityClass(item.ton*TON_TO_STARS)}`;
    div.innerHTML=`${item.name}<br>${Math.round(item.ton*TON_TO_STARS)}‚≠ê`;
    div.onclick=()=>{
      if(confirm(`–ü—Ä–æ–¥–∞—Ç—å ${item.name} –∑–∞ ${Math.round(item.ton*TON_TO_STARS)}‚≠ê?`)){
        stars+=item.ton*TON_TO_STARS;
        inventory.splice(idx,1);
        renderInventory();renderStars();
      }
    };
    inventoryContainer.appendChild(div);
  });
}
function renderForgeCards(){
  forgeCards.forEach((card,i)=>{
    card.textContent=selectedComponents[i]?selectedComponents[i].name:(i==4?"‚≠ê":i==5?"üß©":"+");
  });
  const count=selectedComponents.filter(Boolean).length;
  forgeCards.forEach(c=>c.classList.toggle("forge-ready",count>=2));
}
function renderShop(){
  shopItems.innerHTML="";
  if(shopTab==='mods'){
    modifiersPool.forEach(m=>{
      const cost=500+Math.floor(Math.random()*1000);
      const div=document.createElement("div");
      div.className="shop-item";
      div.innerHTML=`${m.name}<br>${cost}‚≠ê`;
      div.onclick=()=>{if(stars>=cost){stars-=cost;modifiers.push(m);renderStars();alert("–ö—É–ø–ª–µ–Ω–æ "+m.name);}else alert("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∑–≤—ë–∑–¥!");};
      shopItems.appendChild(div);
    });
  } else if(shopTab==='boosts'){
    boostersPool.forEach(b=>{
      const div=document.createElement("div");
      div.className="shop-item";
      div.innerHTML=`${b.name}<br>${b.cost}‚≠ê`;
      div.onclick=()=>{
        if(stars>=b.cost){stars-=b.cost;activeBoosts.push(b);renderStars();alert("–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω "+b.name);}else alert("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∑–≤—ë–∑–¥!");
      };
      shopItems.appendChild(div);
    });
  } else {
    casesPool.forEach(c=>{
      const div=document.createElement("div");
      div.className="shop-item";
      div.innerHTML=`${c.name}<br>${c.cost}‚≠ê`;
      div.onclick=()=>{
        if(stars>=c.cost){
          stars-=c.cost;renderStars();
          const roll=Math.random();
          setTimeout(()=>{
            if(roll<0.7){
              const g=gifts[Math.floor(Math.random()*gifts.length)];
              inventory.push({...g});
              alert(`üéÅ –ò–∑ ${c.name} –≤—ã–ø–∞–ª –ø–æ–¥–∞—Ä–æ–∫: ${g.name}`);
            }else{
              const m=modifiersPool[Math.floor(Math.random()*modifiersPool.length)];
              modifiers.push(m);
              alert(`‚ú® –ò–∑ ${c.name} –≤—ã–ø–∞–ª –º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä: ${m.name}`);
            }
            renderInventory();
          },500);
        }else alert("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∑–≤—ë–∑–¥!");
      };
      shopItems.appendChild(div);
    });
  }
}
function updateShopTimer(){
  shopTimer--;
  shopTimerElem.textContent=`–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–∞–≥–∞–∑–∏–Ω–∞ —á–µ—Ä–µ–∑ ${shopTimer}—Å`;
  if(shopTimer<=0){shopTimer=60;renderShop();}
}

// ---------------------- –ú–û–î–ê–õ–ö–ê ----------------------
forgeCards.forEach((card,i)=>{
  card.onclick=()=>{
    activeCardIndex=i;
    if(i==4){selectedComponents[i]={name:"‚≠ê –ó–≤—ë–∑–¥—ã",ton:Math.random()*5};renderForgeCards();return;}
    if(i==5){selectedComponents[i]={name:"üß© –ú–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä",ton:0};renderForgeCards();return;}
    openModal();
  };
});
function openModal(){modal.style.display="flex";renderModalItems();}
function closeModalFunc(){modal.style.display="none";activeCardIndex=null;}
closeModal.onclick=closeModalFunc;
searchInput.oninput=renderModalItems;
function renderModalItems(){
  modalItems.innerHTML="";
  const filter=searchInput.value.toLowerCase();
  inventory.forEach((item,idx)=>{
    if(item.name.toLowerCase().includes(filter)){
      const div=document.createElement("div");
      div.className="modal-item";
      div.textContent=`${item.name} (${Math.round(item.ton*TON_TO_STARS)}‚≠ê)`;
      div.onclick=()=>{
        selectedComponents[activeCardIndex]=item;
        inventory.splice(idx,1);
        renderForgeCards();
        renderInventory();
        closeModalFunc();
      };
      modalItems.appendChild(div);
    }
  });
}

// ---------------------- –ö–û–í–ö–ê ----------------------
forgeButton.onclick=()=>{
  const components=selectedComponents.filter(Boolean);
  if(components.length<2){forgeResult.textContent="‚ö†Ô∏è –ù—É–∂–Ω–æ –º–∏–Ω–∏–º—É–º 2 –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞!";return;}
  forgeButton.disabled=true;
  forgeButton.textContent="‚õè –ö–æ–≤–∫–∞...";
  forgeResult.textContent="";
  forgeTab.classList.add("forge-anim");
  setTimeout(()=>{
    forgeTab.classList.remove("forge-anim");
    const successChance=50+(modifiers.some(m=>m.effect=="forgePlus10")?10:0)+(activeBoosts.some(b=>b.effect=="boostForge")?20:0);
    if(Math.random()*100<successChance){
      const totalTon=components.reduce((a,b)=>a+b.ton,0);
      const newGift={name:"Forged Gift",ton:totalTon*(1+Math.random())};
      inventory.push(newGift);
      forgeResult.innerHTML=`‚úÖ –£—Å–ø–µ—à–Ω–æ! –ù–æ–≤—ã–π –ø–æ–¥–∞—Ä–æ–∫: <b>${newGift.name}</b> (${Math.round(newGift.ton*TON_TO_STARS)}‚≠ê)`;
      renderInventory();
    }else{
      forgeResult.textContent="üí• –ù–µ—É–¥–∞—á–∞! –í—Å–µ –ø—Ä–µ–¥–º–µ—Ç—ã –ø–æ—Ç–µ—Ä—è–Ω—ã!";
    }
    selectedComponents=Array(6).fill(null);
    renderForgeCards();
    forgeButton.disabled=false;
    forgeButton.textContent="–ö–æ–≤–∞—Ç—å!";
  },2000);
};

// ---------------------- –ù–ê–í–ò–ì–ê–¶–ò–Ø ----------------------
function setActiveTab(tab){
  [forgeTab,inventoryTab,shopTabElem].forEach(t=>t.classList.add('hidden'));
  [navForge,navInventory,navShop].forEach(b=>b.classList.remove('active'));
  if(tab==='forge'){forgeTab.classList.remove('hidden');navForge.classList.add('active');}
  if(tab==='inventory'){inventoryTab.classList.remove('hidden');navInventory.classList.add('active');}
  if(tab==='shop'){shopTabElem.classList.remove('hidden');navShop.classList.add('active');renderShop();}
}
navForge.onclick=()=>setActiveTab('forge');
navInventory.onclick=()=>setActiveTab('inventory');
navShop.onclick=()=>setActiveTab('shop');

shopTabBtns.forEach(btn=>{
  btn.onclick=()=>{
    shopTabBtns.forEach(b=>b.classList.remove('active'));
    btn.classList.add('active');
    shopTab=btn.dataset.tab;
    renderShop();
  };
});

// ---------------------- –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ----------------------
renderStars();
renderInventory();
renderForgeCards();
renderShop();
setInterval(updateShopTimer,1000);
</script>
</body>
</html>
