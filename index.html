<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Gifts Forge</title>
<style>
:root {
  --bg: #0d0d0d;
  --accent: #ff7b00;
  --text: #fff;
  --card-bg: #1a1a1a;
  --card-border: #ff7b00aa;
  --success: #4caf50;
  --fail: #e53935;
  --rare: #00aaff;
  --epic: #a200ff;
  --legendary: #ff0044;
}
*{box-sizing:border-box;font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;}
body{margin:0;background-color:var(--bg);color:var(--text);display:flex;flex-direction:column;height:100vh;overflow:hidden;}
header{text-align:center;padding:12px 0;background:#111;border-bottom:2px solid var(--accent);font-size:1.4rem;letter-spacing:1px;position:relative;z-index:2;}
#starBalance{position:absolute;right:20px;top:12px;font-size:1rem;color:var(--accent);}
#activeBoostDisplay{position:absolute;left:20px;top:12px;font-size:0.9rem;color:var(--accent);}
main{flex:1;display:flex;flex-direction:column;align-items:center;justify-content:flex-start;padding:20px;overflow-y:auto;}
.hidden{display:none;}
.forge-area,.inventory,.shop{text-align:center;max-width:700px;width:100%;border:2px solid var(--card-border);background:var(--card-bg);border-radius:16px;padding:20px;margin-bottom:20px;box-shadow:0 0 10px #ff7b0033;position:relative;}
.forge-cards{display:grid;grid-template-columns:repeat(3,1fr);gap:15px;margin-top:20px;position:relative;}
#lineCanvas{position:absolute;top:0;left:0;width:100%;height:100%;z-index:0;pointer-events:none;}
.forge-card{height:100px;border:2px dashed var(--accent);border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:1.2rem;cursor:pointer;transition:0.3s;background:#222;position:relative;z-index:2;}
#forgeButton{margin-top:20px;background:var(--accent);color:#000;border:none;border-radius:12px;padding:12px 25px;font-size:1.1rem;cursor:pointer;transition:0.2s;}
#forgeButton:hover{transform:scale(1.05);box-shadow:0 0 15px var(--accent);}
.result{margin-top:15px;font-size:1.1rem;color:var(--accent);min-height:1.2em;}
footer{display:flex;justify-content:space-around;border-top:2px solid var(--accent);background:#111;padding:12px 0;position:fixed;bottom:0;width:100%;z-index:3;}
footer button{background:none;border:none;color:var(--text);font-size:1.1rem;cursor:pointer;}
footer button.active{color:var(--accent);font-weight:bold;}
.inventory h2,.shop h2{color:var(--accent);margin-bottom:10px;}
.inventory-tabs{display:flex;justify-content:center;gap:10px;margin-bottom:10px;}
.inv-tab-btn{background:#222;border:1px solid var(--accent);color:var(--accent);padding:6px 12px;border-radius:8px;cursor:pointer;}
.inv-tab-btn.active{background:var(--accent);color:#000;}
.inventory-items,.shop-items{display:flex;flex-wrap:wrap;justify-content:center;gap:10px;}
.inv-item,.shop-item{width:90px;height:90px;border:2px solid var(--accent);border-radius:12px;display:flex;flex-direction:column;align-items:center;justify-content:center;background:#222;text-align:center;padding:5px;font-size:0.8rem;cursor:pointer;transition:.3s;}
.inv-item:hover,.shop-item:hover{background:var(--accent);color:#000;}
.inv-item.rare{border-color:var(--rare);box-shadow:0 0 10px var(--rare);}
.inv-item.epic{border-color:var(--epic);box-shadow:0 0 10px var(--epic);}
.inv-item.legendary{border-color:var(--legendary);box-shadow:0 0 12px var(--legendary);}
.modal{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.85);display:flex;align-items:center;justify-content:center;z-index:1000;display:none;}
.modal-content{background:#111;padding:20px;border:2px solid var(--accent);border-radius:16px;width:90%;max-width:500px;max-height:80%;overflow-y:auto;}
.modal-content h3{color:var(--accent);margin-bottom:10px;}
.toast{position:fixed;bottom:70px;right:20px;background:var(--accent);color:#000;padding:10px 15px;border-radius:10px;box-shadow:0 0 15px var(--accent);animation:fadeInOut 3s ease forwards;z-index:2000;}
@keyframes fadeInOut{0%{opacity:0;transform:translateY(20px);}10%,90%{opacity:1;transform:translateY(0);}100%{opacity:0;transform:translateY(20px);}}
</style>
</head>
<body>
<header>
  üî• Gifts Forge üî• 
  <span id="activeBoostDisplay"></span>
  <span id="starBalance">‚≠ê 10 000</span>
</header>

<main>
  <div id="forgeTab" class="forge-area">
    <h2>–ö—É–∑–Ω–∏—Ü–∞</h2>
    <p>–í—ã–±–µ—Ä–∏ 2‚Äì6 –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –¥–ª—è –∫–æ–≤–∫–∏</p>
    <div class="forge-cards" id="forgeCards">
      <canvas id="lineCanvas"></canvas>
      <div class="forge-card">+</div><div class="forge-card">+</div><div class="forge-card">+</div>
      <div class="forge-card">+</div><div class="forge-card">‚≠ê</div><div class="forge-card">üß©</div>
    </div>
    <button id="forgeButton">–ö–æ–≤–∞—Ç—å!</button>
    <div class="result" id="forgeResult"></div>
  </div>

  <div id="inventoryTab" class="inventory hidden">
    <h2>–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å</h2>
    <div class="inventory-tabs">
      <button class="inv-tab-btn active" data-tab="gifts">üéÅ –ü–æ–¥–∞—Ä–∫–∏</button>
      <button class="inv-tab-btn" data-tab="mods">üß© –ú–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã</button>
      <button class="inv-tab-btn" data-tab="boosts">‚ö° –ë—É—Å—Ç–µ—Ä—ã</button>
    </div>
    <div class="inventory-items" id="inventoryItems"></div>
  </div>

  <div id="shopTab" class="shop hidden">
    <h2>–ú–∞–≥–∞–∑–∏–Ω</h2>
    <div class="shop-tabs">
      <button class="shop-tab-btn active" data-tab="mods">–ú–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã</button>
      <button class="shop-tab-btn" data-tab="boosts">–ë—É—Å—Ç–µ—Ä—ã</button>
    </div>
    <div class="shop-items" id="shopItems"></div>
  </div>
</main>

<footer>
  <button id="navShop">üõí Shop</button>
  <button id="navForge" class="active">üî® Forge</button>
  <button id="navInventory">üéÅ Inventory</button>
</footer>

<script>
const TON_TO_STARS=142;
const gifts = [
  {name:"Plush Pepe", ton:4930},
  {name:"Heart Locket", ton:1210},
  {name:"Durov's Cap", ton:870},
  {name:"Precious Peach", ton:389.5},
  {name:"Heroic Helmet", ton:255},
  {name:"Mighty Arm", ton:199.99},
  {name:"Nail Bracelet", ton:124.8},
  {name:"Astral Shard", ton:119.13},
  {name:"Artisan Brick", ton:110.24},
  {name:"Mini Oscar", ton:93.19},
  {name:"Loot Bag", ton:93},
  {name:"Ion Gem", ton:82.38},
  {name:"Perfume Bottle", ton:80.62},
  {name:"Magic Potion", ton:73.9},
  {name:"Gem Signet", ton:66.89},
  {name:"Scared Cat", ton:57.69},
  {name:"Bonded Ring", ton:53.97},
  {name:"Westside Sign", ton:53.6},
  {name:"Genie Lamp", ton:47},
  {name:"Swiss Watch", ton:40},
  {name:"Sharp Tongue", ton:39.76},
  {name:"Kissed Frog", ton:31.25},
  {name:"Electric Skull", ton:30.4},
  {name:"Signet Ring", ton:27.78},
  {name:"Neko Helmet", ton:27},
  {name:"Low Rider", ton:26.11},
  {name:"Vintage Cigar", ton:25},
  {name:"Toy Bear", ton:24.11},
  {name:"Voodoo Doll", ton:18.88},
  {name:"Mad Pumpkin", ton:18.27},
  {name:"Diamond Ring", ton:18},
  {name:"Eternal Rose", ton:15.17},
  {name:"Ionic Dryer", ton:11.4},
  {name:"Cupid Charm", ton:11.01},
  {name:"Love Potion", ton:10.38},
  {name:"Flying Broom", ton:9.77},
  {name:"Trapped Heart", ton:8.67},
  {name:"Top Hat", ton:8.57},
  {name:"Skull Flower", ton:8.48},
  {name:"Crystal Ball", ton:8.24},
  {name:"Record Player", ton:8},
  {name:"Sky Stilettos", ton:7.32},
  {name:"Love Candle", ton:7.15},
  {name:"Sleigh Bell", ton:6.6},
  {name:"Snoop Cigar", ton:5.89},
  {name:"Hanging Star", ton:5.3},
  {name:"Sakura Flower", ton:5.21},
  {name:"Valentine Box", ton:4.61},
  {name:"Jolly Chimp", ton:4.51},
  {name:"Evil Eye", ton:4.4},
  {name:"Berry Box", ton:3.98},
  {name:"Eternal Candle", ton:3.92},
  {name:"Snow Mittens", ton:3.9},
  {name:"Spy Agaric", ton:3.88},
  {name:"Input Key", ton:3.76},
  {name:"Jelly Bunny", ton:3.75},
  {name:"Bow Tie", ton:3.6},
  {name:"Bunny Muffin", ton:3.46},
  {name:"Light Sword", ton:3.3},
  {name:"Witch Hat", ton:3.14},
  {name:"Hex Pot", ton:3.07},
  {name:"Lush Bouquet", ton:3.07},
  {name:"Joyful Bundle", ton:3.07},
  {name:"Snow Globe", ton:2.89},
  {name:"Restless Jar", ton:2.72},
  {name:"Santa Hat", ton:2.68},
  {name:"Easter Egg", ton:2.61},
  {name:"Star Notepad", ton:2.5},
  {name:"Moon Pendant", ton:2.5},
  {name:"Jack-in-the-Box", ton:2.4},
  {name:"Swag Bag", ton:2.4},
  {name:"Fresh Socks", ton:2.2},
  {name:"Spiced Wine", ton:2.19},
  {name:"Stellar Rocket", ton:2.18},
  {name:"Snoop Dogg", ton:2.15},
  {name:"Cookie Heart", ton:2.12},
  {name:"Jingle Bells", ton:2.12},
  {name:"Tama Gadget", ton:2.11},
  {name:"Hypno Lollipop", ton:2.09},
  {name:"Winter Wreath", ton:2.06},
  {name:"Party Sparkler", ton:2.06},
  {name:"Ginger Cookie", ton:2.05},
  {name:"Big Year", ton:2.02},
  {name:"Jester Hat", ton:2},
  {name:"Holiday Drink", ton:1.93},
  {name:"Pet Snake", ton:1.93},
  {name:"Homemade Cake", ton:1.91},
  {name:"Candy Cane", ton:1.89},
  {name:"Clover Pin", ton:1.88},
  {name:"Whip Cupcake", ton:1.8},
  {name:"Xmas Stocking", ton:1.77},
  {name:"Snake Box", ton:1.72},
  {name:"Lunar Snake", ton:1.7},
  {name:"Lol Pop", ton:1.67},
  {name:"B-Day Candle", ton:1.61},
  {name:"Desk Calendar", ton:1.5}
];

const modifiersPool=[
{name:"+10% —à–∞–Ω—Å —É—Å–ø–µ—Ö–∞",effect:"forgePlus10",desc:"–£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —à–∞–Ω—Å —É—Å–ø–µ—à–Ω–æ–π –∫–æ–≤–∫–∏ –Ω–∞ 10%."},
{name:"+10% –∫ —Ü–µ–Ω–µ",effect:"plus10",desc:"–£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç—å –ø–æ–ª—É—á–µ–Ω–Ω–æ–≥–æ –ø–æ–¥–∞—Ä–∫–∞ –Ω–∞ 10%."},
{name:"¬±30% –∫ —Ü–µ–Ω–µ",effect:"plusminus30",desc:"–°–ª—É—á–∞–π–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ü–µ–Ω—ã –Ω–∞ ¬±30%."},
{name:"15% —à–∞–Ω—Å –≤–µ—Ä–Ω—É—Ç—å",effect:"refund",desc:"15% —à–∞–Ω—Å –≤–µ—Ä–Ω—É—Ç—å –ø–æ—Ç—Ä–∞—á–µ–Ω–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –ø—Ä–∏ –Ω–µ—É–¥–∞—á–µ."}
];
const boostersPool=[
{name:"5 –º–∏–Ω: +20% —É—Å–ø–µ—Ö–∞",effect:"boostForge",desc:"–ù–∞ 5 –º–∏–Ω—É—Ç –ø–æ–≤—ã—à–∞–µ—Ç —à–∞–Ω—Å —É—Å–ø–µ—à–Ω–æ–π –∫–æ–≤–∫–∏ –Ω–∞ 20%.",cost:2000,duration:300000},
{name:"5 –º–∏–Ω: +15% –ø—Ä–æ–¥–∞–∂",effect:"boostSell",desc:"–ù–∞ 5 –º–∏–Ω—É—Ç —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —Ü–µ–Ω—É –ø—Ä–æ–¥–∞–∂–∏ –Ω–∞ 15%.",cost:1500,duration:300000}
];
let stars=10000,inventory=gifts.slice(),modifiers=[],boosters=[],activeBoosts=[],shopTab='mods',selectedComponents=Array(6).fill(null);

const forgeCards=document.querySelectorAll(".forge-card");
const lineCanvas=document.getElementById("lineCanvas"),ctx=lineCanvas.getContext("2d");
function rarityClass(v){if(v>10000)return"legendary";if(v>5000)return"epic";if(v>1000)return"rare";return"";}
function renderStars(){document.getElementById("starBalance").textContent=`‚≠ê ${Math.floor(stars).toLocaleString()}`;}
function renderInventory(tab="gifts"){
const c=document.getElementById("inventoryItems");c.innerHTML="";
let items=tab==="gifts"?inventory:(tab==="mods"?modifiers:boosters);
items.forEach((i,idx)=>{
const div=document.createElement("div");div.className=`inv-item ${rarityClass(i.ton?i.ton*TON_TO_STARS:0)}`;
div.innerHTML=`${i.name}`;if(i.ton)div.innerHTML+=`<br>${Math.round(i.ton*TON_TO_STARS)}‚≠ê`;
div.onclick=()=>{if(tab==="gifts"){if(confirm(`–ü—Ä–æ–¥–∞—Ç—å ${i.name}?`)){stars+=i.ton*TON_TO_STARS;items.splice(idx,1);renderStars();renderInventory(tab);}}else if(tab==="boosts"){activeBoosts.push(i);boosters.splice(idx,1);showToast(`‚ö° –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω ${i.name}`);updateActiveBoostDisplay();renderInventory("boosts");}};
c.appendChild(div);});
}
document.querySelectorAll(".inv-tab-btn").forEach(btn=>{btn.onclick=()=>{document.querySelectorAll(".inv-tab-btn").forEach(b=>b.classList.remove("active"));btn.classList.add("active");renderInventory(btn.dataset.tab);};});
function updateActiveBoostDisplay(){if(activeBoosts.length===0){document.getElementById("activeBoostDisplay").textContent="";return;}let idx=0;const el=document.getElementById("activeBoostDisplay");el.textContent=activeBoosts[0].name;setInterval(()=>{idx=(idx+1)%activeBoosts.length;el.textContent=activeBoosts[idx].name;},5000);}
function showToast(msg){const t=document.createElement("div");t.className="toast";t.textContent=msg;document.body.appendChild(t);
const toasts=document.querySelectorAll(".toast");let offset=70;toasts.forEach(old=>{old.style.bottom=(parseInt(old.style.bottom||70)+50)+"px";});setTimeout(()=>t.remove(),3000);}
function drawLines(){ctx.clearRect(0,0,lineCanvas.width,lineCanvas.height);const rect=lineCanvas.getBoundingClientRect();const pos=[];forgeCards.forEach(c=>{if(c.textContent!=="+"&&c.textContent!=="‚≠ê"&&c.textContent!=="üß©"){const r=c.getBoundingClientRect();pos.push({x:(r.left+r.right)/2-rect.left,y:(r.top+r.bottom)/2-rect.top});}});if(pos.length<2)return;const n=pos.length;const pulse=[1000,750,600,500,330][Math.min(n-2,4)];const intensity=5+n*2;ctx.lineWidth=2+n/2;ctx.strokeStyle=`rgba(255,123,0,0.8)`;ctx.shadowColor="orange";ctx.shadowBlur=intensity;ctx.beginPath();for(let i=0;i<n;i++)for(let j=i+1;j<n;j++){ctx.moveTo(pos[i].x,pos[i].y);ctx.lineTo(pos[j].x,pos[j].y);}ctx.stroke();setTimeout(()=>drawLines(),pulse);}
drawLines();
forgeCards.forEach((c,i)=>{c.onclick=()=>{if(i===4){const amt=parseInt(prompt("–í–≤–µ–¥–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–≤—ë–∑–¥ (1‚Äì1000):","100"));if(!isNaN(amt)&&amt>0){selectedComponents[i]={name:`‚≠ê ${amt}`,ton:amt/TON_TO_STARS};drawLines();}}else if(i===5){if(modifiers.length){selectedComponents[i]=modifiers.pop();showToast("üß© –ú–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä –¥–æ–±–∞–≤–ª–µ–Ω");drawLines();}}else{if(inventory.length){selectedComponents[i]=inventory.pop();drawLines();}}};});
document.getElementById("forgeButton").onclick=()=>{const comps=selectedComponents.filter(Boolean);if(comps.length<2){showToast("‚ö†Ô∏è –ù—É–∂–Ω–æ –º–∏–Ω–∏–º—É–º 2 –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞");return;}let successChance=50;if(comps.find(c=>c.effect==="forgePlus10"))successChance+=10;if(activeBoosts.some(b=>b.effect==="boostForge"))successChance+=20;document.getElementById("forgeButton").disabled=true;setTimeout(()=>{const roll=Math.random()*100;const success=roll<successChance;const totalValue=comps.reduce((s,c)=>s+(c.ton||0),0)*TON_TO_STARS;const evAdj=0.95;let gift;if(success){const avgVal=totalValue*evAdj;gift=gifts.reduce((p,c)=>Math.abs(c.ton*TON_TO_STARS-avgVal)<Math.abs(p.ton*TON_TO_STARS-avgVal)?c:p);inventory.push({...gift});showToast(`üéÅ ${gift.name}!`);}else showToast("üí• –ù–µ—É–¥–∞—á–∞!");selectedComponents=Array(6).fill(null);document.getElementById("forgeButton").disabled=false;drawLines();renderInventory();},2000);};
function renderShop(){const s=document.getElementById("shopItems");s.innerHTML="";const pool=shopTab==="mods"?modifiersPool:boostersPool;pool.forEach(i=>{const div=document.createElement("div");div.className="shop-item";const cost=i.cost||1000;div.innerHTML=`${i.name}<br>${cost}‚≠ê`;div.onclick=()=>{if(stars>=cost){stars-=cost;if(shopTab==="mods")modifiers.push(i);else boosters.push(i);showToast(`‚úÖ –ö—É–ø–ª–µ–Ω–æ: ${i.name}`);renderStars();renderInventory();}else alert("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∑–≤—ë–∑–¥!")};s.appendChild(div);});}
document.querySelectorAll(".shop-tab-btn").forEach(b=>b.onclick=()=>{document.querySelectorAll(".shop-tab-btn").forEach(x=>x.classList.remove("active"));b.classList.add("active");shopTab=b.dataset.tab;renderShop();});
function showTab(t){["forge","inventory","shop"].forEach(x=>document.getElementById(x+"Tab").classList.add("hidden"));document.querySelectorAll("footer button").forEach(b=>b.classList.remove("active"));document.getElementById(t+"Tab").classList.remove("hidden");document.getElementById("nav"+t.charAt(0).toUpperCase()+t.slice(1)).classList.add("active");}
document.getElementById("navForge").onclick=()=>showTab("forge");document.getElementById("navInventory").onclick=()=>showTab("inventory");document.getElementById("navShop").onclick=()=>showTab("shop");
renderStars();renderInventory();renderShop();
</script>
</body>
</html>
